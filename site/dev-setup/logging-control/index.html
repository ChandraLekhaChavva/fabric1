<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="rameshthoomu">
  
  <title>Logging control - ChainCode</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Logging control";
    var mkdocs_page_input_path = "dev-setup/logging-control.md";
    var mkdocs_page_url = "/dev-setup/logging-control/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../extra.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ChainCode</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">HOME</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../CONTRIBUTING/">CONTRIBUTING</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../README/">Getting started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../TravisCI_Readme/">TravisCI Readme</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../glossary/">Glossary</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../protocol-spec/">Protocol spec</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/ChaincodeAPI/">Chaincode APIs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/CoreAPI/">CoreAPI</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/MemberServicesAPI/">MemberServicesAPI</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/SandboxSetup/">SandboxSetup</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>FAQ</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/chaincode_FAQ/">ChaincodeFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/confidentiality_FAQ/">ConfidentialityFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/consensus_FAQ/">ConsensusFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/identity_management_FAQ/">Identity managementFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/usage_FAQ/">UsageFAQ</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Biz</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../biz/usecases/">Usecase</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Dev setup</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ca-setup/">Ca setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../devenv/">Devenv</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../devnet-setup/">Devnet setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../install/">Install</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Logging control</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#logging-control">Logging Control</a></li>
                
                    <li><a class="toctree-l4" href="#overview">Overview</a></li>
                
                    <li><a class="toctree-l4" href="#peer">PEER</a></li>
                
                    <li><a class="toctree-l4" href="#go-chaincodes">Go chaincodes</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tech</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/application-ACL/">Application ACL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/attributes/">Attributes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/best-practices/">Best practices</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ChainCode</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Dev setup &raquo;</li>
        
      
    
    <li>Logging control</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/rameshthoomu/fabric" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="logging-control">Logging Control</h2>
<h3 id="overview">Overview</h3>
<p>Logging in the <code>peer</code> application and in the <em>shim</em> interface to
chaincodes is programmed using facilities provided by the
<code>github.com/op/go-logging</code> package. This package supports</p>
<ul>
<li>Logging control based on the severity of the message</li>
<li>Logging control based on the software <em>module</em> generating the message</li>
<li>Different pretty-printing options based on the severity of the message</li>
</ul>
<p>All logs are currently directed to <strong>stderr</strong>, and the pretty-printing is
currently fixed. However global and module-level control of logging by
severity is provided for both users and developers.  There are currently no
formalized rules for the types of information provided at each severity level,
however when submitting bug reports the developers may want to see full logs
down to the DEBUG level.</p>
<p>In pretty-printed logs the logging level is indicated both by color and by a
4-character code, e.g, "ERRO" for ERROR, "DEBU" for DEBUG, etc.  In the
logging context a <em>module</em> is an arbitrary name (string) given by developers
to groups of related messages.  In the pretty-printed example below, the
logging modules "peer", "rest" and "main" are generating logs.</p>
<pre><code>16:47:09.634 [peer] GetLocalAddress -&gt; INFO 033 Auto detected peer address: 9.3.158.178:30303
16:47:09.635 [rest] StartOpenchainRESTServer -&gt; INFO 035 Initializing the REST service...
16:47:09.635 [main] serve -&gt; INFO 036 Starting peer with id=name:"vp1" , network id=dev, address=9.3.158.178:30303, discovery.rootnode=, validator=true
</code></pre>
<p>An arbitrary number of logging modules can be created at runtime, therefore
there is no "master list" of modules, and logging control constructs can not
check whether logging modules actually do or will exist.</p>
<h3 id="peer">PEER</h3>
<p>The logging level of the <code>peer</code> command can be controlled from the command
line for each invocation using the <code>--logging-level</code> flag, for example</p>
<pre><code>peer node start --logging-level=debug
</code></pre>
<p>The default logging level for each individual <code>peer</code> subcommand can also
be set in the <strong>openchain.yaml</strong> file. For example the key <code>logging.peer</code> sets
the default level for the <code>peer</code> subcommmand.</p>
<p>Logging severity levels are specified using case-insensitive strings chosen
from</p>
<pre><code>CRITICAL | ERROR | WARNING | NOTICE | INFO | DEBUG
</code></pre>
<p>The full logging level specification for the <code>peer</code> is of the form</p>
<pre><code>[&lt;module&gt;[,&lt;module&gt;...]=]&lt;level&gt;[:[&lt;module&gt;[,&lt;module&gt;...]=]&lt;level&gt;...]
</code></pre>
<p>A logging level by itself is taken as the overall default. Otherwise,
overrides for individual or groups of modules can be specified using the </p>
<pre><code>&lt;module&gt;[,&lt;module&gt;...]=&lt;level&gt;
</code></pre>
<p>syntax. Examples of <level> specifications (valid for both --logging-level and
<strong>openchain.yaml</strong> settings):</p>
<pre><code>info                                       - Set default to INFO
warning:main,db=debug:chaincode=info       - Default WARNING; Override for main,db,chaincode
chaincode=info:main=debug:db=debug:warning - Same as above
</code></pre>
<h3 id="go-chaincodes">Go chaincodes</h3>
<p>As independently executed programs, user-provided chaincodes can use any
appropriate technique to create their private logs - from simple print
statements to fully-annotated and level-controlled logs. The chaincode <em>shim</em>
package provides APIs that allow a chaincode to create and manage logging
objects whose logs will be formatted and interleaved consistently with the
<em>shim</em> logs.</p>
<p><code>NewLogger(name string) *ChaincodeLogger</code> - Create a logging object for use by a chaincode</p>
<p><code>(c *ChaincodeLogger) SetLevel(level LoggingLevel)</code> - Set the logging level of the logger</p>
<p><code>(c *ChaincodeLogger) IsEnabledFor(level LoggingLevel) bool</code> - Return true if logs will be generated at the given level</p>
<p><code>LogLevel(levelString string) (LoggingLevel, error)</code> - Convert a string to a <code>LoggingLevel</code></p>
<p>A <code>LoggingLevel</code> is a member of the enumeration</p>
<pre><code>LogDebug, LogInfo, LogNotice, LogWarning, LogError, LogCritical
</code></pre>

<p>which can be used directly, or generated by passing a case-insensitive version
of the strings</p>
<pre><code>DEBUG, INFO, NOTICE, WARNING, ERROR, CRITICAL
</code></pre>

<p>to the <code>LogLevel</code> API.</p>
<p>Formatted logging at various severity levels is provided by the functions</p>
<pre><code>(c *ChaincodeLogger) Debugf(format string, args ...interface{})
(c *ChaincodeLogger) Infof(format string, args ...interface{})
(c *ChaincodeLogger) Noticef(format string, args ...interface{})
(c *ChaincodeLogger) Warningf(format string, args ...interface{})
(c *ChaincodeLogger) Errorf(format string, args ...interface{})
(c *ChaincodeLogger) Criticalf(format string, args ...interface{})
</code></pre>

<p>In the current implementation, the logs produced by the <em>shim</em> and a
<code>ChaincodeLogger</code> are timestamped, marked with the logger <em>name</em> and severity
level, and written to <em>stderr</em>. Note that logging level control is currently
based on the <em>name</em> provided when the <code>ChaincodeLogger</code> is created. To avoid
ambiguities, all <code>ChaincodeLogger</code> should be given unique names other than
"shim". The logger <em>name</em> will appear in all log messages created by the
logger. The <em>shim</em> logs as "shim".</p>
<p>Go language chaincodes can also control the logging level of the chaincode
<em>shim</em> interface through the <code>SetLoggingLevel</code> API.</p>
<p><code>SetLoggingLevel(LoggingLevel level)</code> - Control the logging level of the shim</p>
<p>The default logging level for the shim is <code>LogDebug</code>.</p>
<p>Below is a simple example of how a chaincode might create a private logging
object logging at the <code>LogInfo</code> level, and also control the amount of logging
provided by the <em>shim</em> based on an environment variable.</p>
<pre><code>var logger = shim.NewLogger(&quot;myChaincode&quot;)

func main() {

    logger.SetLevel(shim.LogInfo)

    logLevel, _ := shim.LogLevel(os.Getenv(&quot;SHIM_LOGGING_LEVEL&quot;))
    shim.SetLoggingLevel(logLevel)
    ...
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../tech/application-ACL/" class="btn btn-neutral float-right" title="Application ACL">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../install/" class="btn btn-neutral" title="Install"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://github.com/rameshthoomu/fabric.git">Fabric ChainCode</a>, <a href="http://chaincode-docs.readthedocs.io/en/latest/README/">README</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/rameshthoomu/fabric" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../install/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../tech/application-ACL/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
