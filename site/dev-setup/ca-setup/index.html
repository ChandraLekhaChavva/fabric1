<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="rameshthoomu">
  
  <title>Ca setup - ChainCode</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Ca setup";
    var mkdocs_page_input_path = "dev-setup/ca-setup.md";
    var mkdocs_page_url = "/dev-setup/ca-setup/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../extra.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ChainCode</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">HOME</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../CONTRIBUTING/">CONTRIBUTING</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../README/">Getting started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../TravisCI_Readme/">TravisCI Readme</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../glossary/">Glossary</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../protocol-spec/">Protocol spec</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/ChaincodeAPI/">Chaincode APIs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/CoreAPI/">CoreAPI</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/MemberServicesAPI/">MemberServicesAPI</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/SandboxSetup/">SandboxSetup</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>FAQ</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/chaincode_FAQ/">ChaincodeFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/confidentiality_FAQ/">ConfidentialityFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/consensus_FAQ/">ConsensusFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/identity_management_FAQ/">Identity managementFAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../FAQ/usage_FAQ/">UsageFAQ</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Biz</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../biz/usecases/">Usecase</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Dev setup</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Ca setup</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#certificate-authority-ca-setup">Certificate Authority (CA) Setup</a></li>
                
                    <li><a class="toctree-l4" href="#overview">Overview</a></li>
                
                    <li><a class="toctree-l4" href="#configuration">Configuration</a></li>
                
                    <li><a class="toctree-l4" href="#build-and-run">Build and Run</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../devenv/">Devenv</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../devnet-setup/">Devnet setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../install/">Install</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../logging-control/">Logging control</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tech</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/application-ACL/">Application ACL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/attributes/">Attributes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/best-practices/">Best practices</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ChainCode</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Dev setup &raquo;</li>
        
      
    
    <li>Ca setup</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/rameshthoomu/fabric" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="certificate-authority-ca-setup">Certificate Authority (CA) Setup</h1>
<h2 id="overview">Overview</h2>
<p>The <em>Certificate Authority</em> (CA) provides a number of certificate services to users of a blockchain.  More specifically, these services relate to <em>user enrollment</em>, <em>transactions</em> deployed or invoked on the blockchain, and <em>TLS</em>-secured connections between users or components of the blockchain.</p>
<h3 id="enrollment-certificate-authority">Enrollment Certificate Authority</h3>
<p>The <em>enrollment certificate authority</em> (ECA) is the place where new users are initially registered with the blockchain and where those users can then request an <em>enrollment certificate pair</em>.  One certificate is for data signing, one is for data encryption.  The public keys to be embedded in the certificates have to be of type ECDSA, whereby the key for data encryption is then converted by the user to be used in an <a href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme">ECIES</a> (Elliptic Curve Integrated Encryption System) fashion.</p>
<h3 id="transaction-certificate-authority">Transaction Certificate Authority</h3>
<p>Once a user is enrolled, he or she can request <em>transaction certificates</em> from the <em>transaction certificate authority</em> (TCA) to be used for deployment and invocation transactions on the blockchain.  Although a single transaction certificate can be used for multiple transactions, for privacy reasons it is recommended to use a new transaction certificate for each transaction.</p>
<h3 id="tls-certificate-authority">TLS Certificate Authority</h3>
<p>In addition to enrollment and transaction certificates, users of the blockchain need <em>TLS certificates</em> for TLS-securing their communication channels.  TLS certificates can be requested from the <em>TLS certificate authority</em> (TLSCA).</p>
<h2 id="configuration">Configuration</h2>
<p>All CA services are provided by a single process, which can be configured to some extent by setting parameters in the CA configuration file membersrvc.yaml, which is located in root of the same directory as the CA binary.  More specifically, the following parameters can be set:</p>
<ul>
<li><code>server.gomaxprocs</code>: limits the number of operating system threads used by the CA.</li>
<li><code>server.rootpath</code>: the root path of the directory where the CA stores its state.</li>
<li><code>server.cadir</code>: the name of the directory where the CA stores its state.</li>
<li><code>server.port</code>: the port at which all CA services listen (multiplexing of services over the same port is provided by <a href="http://www.grpc.io">GRPC</a>).</li>
</ul>
<p>Furthermore, logging levels can be enabled/disabled by adjusting the following settings:</p>
<ul>
<li><code>logging.trace</code> (off by default, useful for debugging the code only)</li>
<li><code>logging.info</code></li>
<li><code>logging.warning</code></li>
<li><code>logging.error</code></li>
<li><code>logging.panic</code></li>
</ul>
<p>Alternatively, these fields can be set via environment variables, which---if set---have precedence over entries in the yaml file.  The corresponding environment variables are named as follows:</p>
<pre><code>MEMBERSRVC_CA_SERVER_GOMAXPROCS
MEMBERSRVC_CA_SERVER_ROOTPATH
MEMBERSRVC_CA_SERVER_CADIR
MEMBERSRVC_CA_SERVER_PORT
</code></pre>
<p>In addition, the CA may be preloaded with registered users, where each user's name, roles, and password are specified:</p>
<pre><code>eca:
    users:
        alice: 2 DRJ20pEql15a
        bob: 4 7avZQLwcUe9q
</code></pre>
<p>The role value is simply a bitmask of the following:</p>
<pre><code>CLIENT = 1;
PEER = 2;
VALIDATOR = 4;
AUDITOR = 8;
</code></pre>
<p>For example, a peer who is also a validator would have a role value of 6.</p>
<p>When the CA is started for the first time, it will generate all of its required states (e.g., internal databases, CA certificates, blockchain keys, etc.) and writes this state to the directory given in its configuration.  The certificates for the CA services (i.e., for the ECA, TCA, and TLSCA) are self-signed as the current default.  If those certificates shall be signed by some root CA, this can be done manually by using the <code>*.priv</code> and <code>*.pub</code> private and public keys in the CA state directory, and replacing the self-signed <code>*.cert</code> certificates with root-signed ones..  The next time the CA is launched, it will read and use those root-signed certificates.</p>
<h2 id="build-and-run">Build and Run</h2>
<p>The CA can be built with the following command executed in the <code>membersrvc</code> directory:</p>
<pre><code>cd $GOPATH/src/github.com/hyperledger/fabric
make membersrvc
</code></pre>
<p>The CA can be started with the following command:</p>
<pre><code>build/bin/membersrvc
</code></pre>
<p>The CA looks for an <code>membersrvc.yaml</code> configuration file in $GOPATH/src/github.com/hyperledger/fabric/membersrvc.  If the CA is started for the first time, it creates all its required state (e.g., internal databases, CA certificates, blockchain keys, etc.) and write each state to the directory given in the CA configuration.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../devenv/" class="btn btn-neutral float-right" title="Devenv">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../biz/usecases/" class="btn btn-neutral" title="Usecase"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://github.com/rameshthoomu/fabric.git">Fabric ChainCode</a>, <a href="http://chaincode-docs.readthedocs.io/en/latest/README/">README</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/rameshthoomu/fabric" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../biz/usecases/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../devenv/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
